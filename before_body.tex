
\newcommand\titre{Tableaux de bord \\ des établissements de \\ l'Enseignement Supérieur \\ et de la Recherche}
\newcommand\auteur{Julien Gossa}
\newcommand\rentree{Edition 2019-2020}
\newcommand\ladate{Novembre 2021}
\newcommand\reportid{tdbesr-2021-v1.0}

\definecolor{royalblue(traditional)}{rgb}{0.0, 0.14, 0.4}
\definecolor{royalblue(web)}{rgb}{0.25, 0.41, 0.88}

\newcommand\titleY{0cm}
\newcommand\titleS{3}
\newcommand\titleBoxW{19cm}
\newcommand\titleBoxH{11cm}
\newcommand\titleBoxR{7}


\begin{titlepage}

\begin{tikzpicture}[overlay,remember picture]

  \coordinate (logo) at (current page.north west);
  \coordinate (title) at ($(current page.center) + (0,\titleY)$);
  \coordinate (author) at (current page.south east);

\node (nlogo) [inner sep=20pt, anchor=north west] at (logo)
  {\includegraphics[width=8cm]{files/logo_cpesr_sackersgothic}};

\node (bandeau) at (title) 
  [draw, minimum width=\titleBoxW, minimum height=\titleBoxH, rotate=\titleBoxR, color=royalblue(web), fill=royalblue(web)] {};

\node (ntitle) at (title) 
  [inner sep=0pt, anchor=center, align=center, font=\bfseries, scale=\titleS, align=center, color=white]  
  {\titre};

\node (nrentree) at ($(bandeau.south west)!0.95!(bandeau.south east)$)
  [inner sep=10pt, anchor=south east, rotate=\titleBoxR, font=\Huge, color=white]
  {\rentree};

\node (num) at ($(bandeau.south west)!0.94!(bandeau.south east)$)
  [inner sep=5pt, anchor=north east, rotate=\titleBoxR, font=\large]
  {\reportid};

\node (nauteur) at (author) 
  [inner sep=50pt, anchor=south east, align=center, font=\huge, align=left, color =black]
  {\textbf{\ladate} \\ \auteur};

  
\end{tikzpicture}

\end{titlepage}




\newlength{\graphesX}
\setlength{\graphesX}{0.33\textheight}
\newlength{\graphesY}
\setlength{\graphesY}{-0.04\textheight}
\newlength{\graphesW}
\setlength{\graphesW}{0.3\paperwidth}
\newlength{\graphesH}
\setlength{\graphesH}{0.9\paperheight}
\newlength{\kpiW}
\setlength{\kpiW}{0.6\paperwidth}
\newlength{\kpiH}
\setlength{\kpiH}{0.9\paperheight}


\newcommand\maketdb[4]{
  \begin{tikzpicture}[overlay,remember picture]
    \node (ancetres) [inner sep=0pt, anchor=north west, xshift=\graphesX, yshift=\graphesY] at (current page.north west)
      {\includegraphics[height=0.33\graphesH]{#1}};
    \node (associations) [inner sep=0pt, anchor=north] at (ancetres.south)
      {\includegraphics[height=0.33\graphesH]{#2}};
    \node (composantes) [inner sep=0pt, anchor=north,yshift=-0pt] at (associations.south)
      {\includegraphics[height=0.33\graphesH]{#3}};
      
    \node (kpi) [inner sep=0pt, anchor=north east, color=red, minimum height=\kpiH, yshift=\graphesY, xshift=\graphesY] at (current page.north east)
      {\includegraphics[height=\kpiH]{#4}};

    \node (ancetres-tit) [inner sep=0pt, anchor=south] at (ancetres.north) {\bf Filiation};
    \node (associations-tit) [inner sep=0pt, anchor=south] at (associations.north) {\bf Association};
    \node (composantes-tit) [inner sep=0pt, anchor=south] at (composantes.north) {\bf Composition};

  \end{tikzpicture}
}


%%%%%%%%%%%%%%%%%%%%%%%% 

\newlength{\widthB}
\setlength{\widthB}{0.17\paperwidth}
\newlength{\widthG}
\setlength{\widthG}{0.8\paperwidth}
\newif\ifsection


\newcommand\etabheader[9][false] {%
  \ifthenelse{\equal{#1}{section}}{\sectiontrue}{\sectionfalse}

  \newpage
  \begin{tikzpicture}[overlay,remember picture]
    \node (combandeau) at (current page.north west) 
      [draw, minimum width=\widthB, minimum height=\paperheight, anchor=north west, color=royalblue(web), fill=royalblue(traditional)] {};
    \ifsection
      \node (section) at (combandeau.north west) [color=red, anchor=north west, inner sep=1cm, scale=1] {
        \begin{minipage}{2cm} \color{white} \section{#2} \end{minipage}};
    \fi
    \node (titre) at (combandeau.center) [color=red, anchor=center, yshift=2.5cm, rotate=90, scale=1] {
      \begin{minipage}{12cm} \color{white} \bf \Huge \raggedright #2 \end{minipage}};
    \node (infos) at (current page.south west) [anchor=south west, yshift=+2cm] {
      \begin{minipage}[t]{\widthB}
        \footnotesize
        \centering
        \color{white}
        \hypersetup{%
        colorlinks=white,% hyperlinks will be black
        urlbordercolor=white,% hyperlink borders will be red
        pdfborderstyle={/S/U/W 1}% border style will be underline of width 1pt
        }
        \mbox{#6} 
        \newline ~ \newline
        \begin{tabular*}{\textwidth}{rl}
          Type :      & #3  \\ 
          Décret :    & \mbox{#8} \\
          UAI :       & #5 \\
          Wikidata :  & \mbox{#7} \\
        \end{tabular*}
      \end{minipage}
    };
    \node (graphiques) [inner sep=0pt, anchor=east] at (current page.east) [xshift=-0.5cm]
      {\includegraphics[width=\widthG]{#9}};
    
  \end{tikzpicture}
}%
  
